{{ 'section-image-with-list.css' | asset_url | stylesheet_tag }}

{% liquid
  assign title = section.settings.title
  assign subtitle = section.settings.subtitle
  assign color_scheme = section.settings.color_scheme
  assign list_item = section.blocks | where: 'type', 'list-item'
%}

{% render 'section-paddings',
  padding_top: section.settings.padding_top,
  padding_bottom: section.settings.padding_bottom,
  padding_top_mobile: section.settings.padding_top_mobile,
  padding_bottom_mobile: section.settings.padding_bottom_mobile
%}

<div class="section-{{ section.id }}--padding color-{{ color_scheme }}">
    <div class="image-with-list page-width">
      {% if title != blank or subtitle != blank %}
       <div class="image-with-list__heading-content">
         {% if title != blank %}
          <h2 class="h2 image-with-list__title">{{ title }}</h2>
        {% endif %}
        {% if subtitle != blank %}
          <p class="image-with-list__subtitle text--medium">{{ subtitle }}</p>
        {% endif %}
       </div>
      {% endif %}
      <div class="image-with-list__grid{% if section.settings.layout == 'text_first' %} image-with-list__grid--reverse{% endif %} color-{{ card_color_scheme }}">
        <div class="image-with-list__media-item">
          <div class="image-with-list__media">
            {% if section.settings.video != blank %}
              <video-wrapper>
                {{
                section.settings.video
                  | video_tag:
                  image_size: '1100x',
                  autoplay: section.settings.autoplay,
                  controls: section.settings.controls,
                  loop: section.settings.loop,
                  muted: section.settings.muted
                }}
                {% if section.settings.autoplay != true and section.settings.controls != true %}
                  <span class="image-with-list__play" data-play-button>
                    {{ 'icon-play.svg' | inline_asset_content }}
                  </span>
                {% endif %}
              </video-wrapper>
            {%- else -%}
              {% render 'picture',
                image: section.settings.image,
                image_mobile: section.settings.image_mobile,
                media_request: 650,
                widths_list: '350,800',
                loading: 'lazy',
                fetchpriority: 'low',
                class: 'image'
              %}
            {%- endif -%}
          </div>
        </div>
        <div class="image-with-list__text-item">
          {% if list_item.size > 0 %}
            <ul class="image-with-list__group list-unstyled">
              {% for block in list_item %}
                {% liquid
                  assign icon = block.settings.icon
                  assign title = block.settings.title
                  assign text = block.settings.text
                %}
                <li class="image-with-list__item" {{ block.shopify_attributes }}>
                  {% if icon != blank %}
                    <div class="image-with-list__image">
                      {{ icon | image_url: width: 1000 | image_tag: alt: icon.alt }}
                    </div>
                  {% endif %}
                  {% if title != blank or text != blank %}
                    <div class="image-with-list__content">
                      {% if title != blank %}
                        <h3 class="h4">{{ title }}</h3>
                      {% endif %}
                      {% if text != blank %}
                        <p class="text--small">{{ text }}</p>
                      {% endif %}
                    </div>
                  {% endif %} 
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>
    </div>
</div>

{% schema %}
{
  "name": "Image with list",
  "tag": "section",
  "disabled_on": {
    "groups": ["header"]
  },
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Paddings"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top mobile",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding bottom mobile",
      "default": 36
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Image mobile"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "muted",
      "label": "Muted",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Loop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "controls",
      "label": "Controls",
      "default": true
    },
    {
      "type": "select",
      "id": "layout",
      "options": [
        {
          "value": "image_first",
          "label": "Image first"
        },
        {
          "value": "text_first",
          "label": "Text first"
        }
      ],
      "default": "image_first",
      "label": "Desktop image placement"
    },
    {
      "type": "header",
      "content": "Text content"
    },
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "Title"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle"
    }
  ],
  "blocks": [
    {
      "type": "list-item",
      "name": "List Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image with list"
    }
  ]
}
{% endschema %}