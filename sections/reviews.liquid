{{ 'section-reviews.css' | asset_url | stylesheet_tag }}

{% liquid 
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign padding_top_mobile = section.settings.padding_top_mobile
  assign padding_bottom_mobile = section.settings.padding_bottom_mobile

  assign title = section.settings.heading
%}
{% render  'section-paddings',
	padding_top: padding_top,
	padding_bottom: padding_bottom,
	padding_top_mobile: padding_top_mobile,
	padding_bottom_mobile: padding_bottom_mobile
%}

{% capture sliderSettings %}
  {
    "slidesPerView": "auto",
    "pagination": {
      "el": ".swiper-pagination--{{ section.id }}",
      "type": "bullets"
    }
  }
{% endcapture  %}

<div class="page-width section-{{ section.id }}--padding">
  <div class="reviews__wrapper color-{{ section.settings.color_scheme }}">

  {% if title != blank %}
    <h2 class="h2">{{ title }}</h2>
  {% endif %}
    <div class="swiper" {% render 'slider-attribute', config: sliderSettings, is_observable: true %}>
      <ul class="reviews__list list-unstyled swiper-wrapper">
        {% for block in section.blocks %}
          {% if block.type == 'review' %}
            {% liquid
              assign rating = block.settings.rating
              assign title = block.settings.title
              assign review = block.settings.review
              assign richtext = block.settings.richtext
            %}
            <li class="swiper-slide" {{ block.shopify_attributes }}>
              <div class="review">
                <div class="review__rating banner--content-align-{{ section.settings.desktop_content_alignment }} banner--content-align-mobile-{{ section.settings.mobile_content_alignment }}" {{ block.shopify_attributes }}>
                  <div class="review__rating-stars--unfilled">
                    {% if block.settings.rating_image != blank %}
                      {{ block.settings.rating_image | image_url: width: 300 | image_tag }}
                    {% else %}
                      {%- for star in (1..5) -%}
                        {%- render 'icon-star', color: '#C7C7C7' -%}
                      {%- endfor -%}
                      <div
                      class="review__rating-stars--filled"
                      style="width: {{ rating | times: 20.0 }}%;"
                      >
                      {%- for star in (1..5) -%}
                        {%- render 'icon-star', color: 'rgb(172 77 128)' -%}
                      {%- endfor -%}
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% if title != blank %}
                  <h3 class="review__title">{{ title }}</h3>
                {% endif %}
                {% if review != blank %}
                  <div class="review__content">{{ review }}</div>
                {% endif %}
                {% if richtext != blank %}
                  <div class="review__author">{{ richtext }}</div>
                {% endif %}
              </div>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
      <div class="swiper-pagination swiper-pagination--{{ section.id }}"></div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Reviews",
  "tag": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Section's space between"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 50,
      "unit": "px",
      "label": "Padding Top"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 50,
      "unit": "px",
      "label": "Padding Bottom"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Top Mobile"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Bottom Mobile"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Title"
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Review",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "min": 0,
          "max": 5,
          "step": 0.1,
          "label": "Rating",
          "default": 5
        },
        {
          "type": "image_picker",
          "id": "rating_image",
          "label": "Rating image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "textarea",
          "id": "review",
          "label": "Review"
        },
        {
          "type": "richtext",
          "id": "richtext",
          "label": "Richtext"
        }
      ]
    }
  ],
   "presets": [
    {
      "name": "Reviews"
    }
  ]
}
{% endschema %}